<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $.support.cors = true;
    // const callback = (error, data) => {
    //     if (error) {
    //         console.log('>>>calling callback with error: ', error)
    //     }
    //     if (data) {
    //         console.log('>>>calling callback with data: ', data)
    //     }
    // }
    // CÁCH SỬ DỤNG RƠI VÀO TRƯỜNG HỢP BỊ CALLBACK HELL

    // function getTodos(id, callback) {
    //     var checkRequest = new XMLHttpRequest();
    //     checkRequest.onreadystatechange = function () {
    //         if (this.readyState === 4 && checkRequest.status === 200) {
    //             const data = JSON.parse(checkRequest.responseText)
    //             const dataString = JSON.stringify(data)
    //             callback(undefined, data)
    //         }
    //         if (this.readyState === 4 && checkRequest.status !== 200) {
    //             callback("something wrong: ", undefined)
    //         }
    //     };
    //     checkRequest.open("GET", `https://jsonplaceholder.typicode.com/todos/${id}`, true);
    //     checkRequest.withCredentials = true;
    //     checkRequest.send();

    // }

    // getTodos(1, callback);



    //  TRƯỜNG HỢP DÙNG PROMISES GIẢI QUYẾT CALLBACK HELL

    // function getTodos(id) {
    //     return new Promise((resolve, reject) => {
    //         var checkRequest = new XMLHttpRequest();
    //         checkRequest.onreadystatechange = function () {
    //             if (this.readyState === 4 && checkRequest.status === 200) {
    //                 const data = JSON.parse(checkRequest.responseText)
    //                 const dataString = JSON.stringify(data)
    //                 resolve(data)
    //             }
    //             if (this.readyState === 4 && checkRequest.status !== 200) {
    //                 reject("something wrong at id: ", id)
    //             }
    //         };
    //         checkRequest.open("GET", `https://jsonplaceholder.typicode.com/todos/${id}`, true);
    //         checkRequest.withCredentials = true;
    //         checkRequest.send();
    //     })
    // }

    // getTodos(1)
    //     .then(data1 => {
    //         console.log("check data1: ", data1)
    //         return getTodos(2)
    //     })
    //     .then(data2 => {
    //         console.log("check data2 : ", data2)
    //         return getTodos(3)
    //     })
    //     .then(data3 => {
    //         console.log("check data3: ", data3)
    //     })
    //     .catch(error => {
    //         console.log("check error fail: ", error)
    //     })


    // TRƯỜNG HỢP DÙNG FETCH API
    // fetch(`https://jsonplaceholder.typicode.com/todos/1`)
    //     .then(Response => {
    //         return Response.json()
    //     })
    //     .then(data => { console.log("check data: ", data) })


    // TRƯỜNG HỢP DÙNG ASYNC/AWAIT IN JS
    const getData = async (id) => {
        let response = await fetch(`https://jsonplaceholder.typicode.com/todos/${id}`)
        if (response && response.status !== 200) {
            throw new Error("Something wrong with error status: " + response.status)
        }
        console.log("check reponse: ", response)
        let data = await response.json();
        return data
    }
    getData(1)
        .then(data => {
            console.log("check data: ", data)
            return getData("ádsda")
        })
        .then(data2 => console.log("check data2: ", data2))
        .catch(err => { console.log("check error: ", err.message) })
</script>

<body>
    <div>
        Hello word hehehe
    </div>

</body>

</html>